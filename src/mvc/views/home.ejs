<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <script defer src="https://unpkg.com/peerjs@1.2.0/dist/peerjs.min.js"></script>
  <link rel="stylesheet" href="css/style.css" >
  <link rel="stylesheet" href="css/home.css" >
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <title>Home</title>
</head>
<body>
  <div class="container">
      <div class="boxHome">
        <div class="boxroom">
            <div class="createroom">
                <input type="text" id="ip_createroom" value="">
                <button onclick="createRoom()" type="button">Tạo phòng</button>              
            </div>
            <div class="listroom">
                <h3>Phòng</h3>
                <div class="row rowRoom">
                    <% for (var i = 0; i < rooms.length; i++) { %>
                        <div data-roomid="<%= rooms[i]['room_id'] %>" class="col-auto col-md-2">
                            <div class="room_num">
                                <%= rooms[i]['room_name'] %>
                            </div>
                            <div class="roomMenu">
                                <% if(rooms[i]['user_id_join'] == null && rooms[i]['boss_room_user_id'] != user['id']){ %>
                                    <i class="fa-solid fa-circle-plus"></i>
                                <% }else{%>      
                                <i class="iMenu fa-solid fa-ellipsis-vertical">
                                    <div class="listAction">
                                        <i class="fa-solid fa-right-to-bracket"></i>
                                        <i class="fa-solid fa-phone"></i>
                                        <i class="fa-brands fa-facebook-messenger"></i>
                                    </div>
                                </i>
                                <% } %>    
                            </div>
                           
                        </div>
                    <% } %>
                </div>
            </div>
        </div>
        <div class="boxusers">
            <h3>Người dùng</h3>
            <div class="row">
                <% for (var i = 0; i < users.length; i++) { %>
                    <div class="col-md-3">
                        <div data-userid="<%= users[i].id %>" data-peerid="<%= user['peer_id'] %>" data-fullname="<%= users[i].fullname %>"  class="item-user">
                            <div class="row">
                                <div class="col-md-3">
                                        <div class="boxavatar">
                                            <img src="https://i.stack.imgur.com/l60Hf.png" alt="">
                                        </div>
                                </div>
                                <div class="col-md-9">
                                    <div class="boxinfo">
                                        <div class="top">
                                            <div class="name"><%= users[i].fullname %></div>
                                            <div class="stateOnline off"><span></span></div>
                                        </div>
                                        <div class="bottom">
                                            <div class="phone"><i class="fas fa-phone-alt"></i></div>
                                            <div class="message"><i class="fab fa-facebook-messenger"></i></div>
                                        </div>
                                    </div>
                                </div>
                            </div> 
                        </div>
                    </div>
                <% } %>
            </div>
        </div>          
      </div>

  </div>
  <%- include('commingcall'); %>
  <%- include('requestcall'); %>
</body>
<% var tempuserid = 0 %>
<%if (user) { %>
  <% var tempuserid = user['id'] %>
<% }%>
<script> 
let user_id  = "<%= tempuserid %>"; 
let peerId = "<%= user['peer_id'] %>"; 
</script> 
<link rel="stylesheet" href="lib/advanced-bootstrap-toast/css/bs4Toast.css" >
<script src="lib/advanced-bootstrap-toast/js/bs4-toast.js" defer></script>
<script src="/socket.io/socket.io.js" defer></script>
<script src="socket-global.js" defer></script>
<script src="home.js" defer></script>
<script src="commingcall.js" defer></script>
</html>